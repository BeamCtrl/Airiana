<!DOCTYPE html>
<html lang="en">

   <head>
      <title>Select Box Control</title>
   </head>
   <script>
      setForm()
      getSSID()

      function setForm(){
         var form = "<form action=" + window.location.hostname + ":8000/setup method=post>"
         form += "<a>Choose your home Wi-Fi network:</a><br>"
         form += "<div id=\"networks\" style=\"line-height:90%\"></div>"
         form += "<label for=\"password\">Password:</label>"
         form += "<input type=\"password\" id=\"password\" name=\"Password\"><br>"
         form += "<input type=\"submit\" value=\"Configure Airiana\"><br><br>"
         form += "</form>"
         document.getElementById("uForm").innerHTML = form
      }
      function getSSID() {
        myVar =   setInterval(getSSID,30000);
        var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function() {
          if (xhttp.readyState == 4 && xhttp.status == 200) {
            const ssids = xhttp.responseText.split(" ")
            data = "<select name = \"network\">"
            console.log(ssids)
            if (ssids[0] == ""){
                ssids[0] = "Loading Wi-Fi access points..."
            }
            for (let i = 0; i < ssids.length; i++) {
                if(ssids[i] != "ESSID:"){
                    data += "<option value= \"" + ssids[i] + "\">" + ssids[i] + "</option>";
                }
            }
            data += "</select><br>"
            console.log(data)
            //data = data.replace(/\\n/g,"<br>");
            data = data.replace(/ESSID:/g,"");
            //data = data.replace(/\"/g,"");
            //data = data.replace(/\ /g,"");
            //data = data + "mina ssids"
            document.getElementById("networks").innerHTML = data;
          }
        };
        xhttp.open("GET", "SSID", true);
        xhttp.send();
      }


   </script>
   <body>
      <p>Airiana Wi-Fi access point.<br> Select your network and fill in your password, then press configure.</p>
      <br>
      <br>
      <!--form action= window.location.hostname :8000/setup" method="post"-->
      <div id="uForm">uform</div>
   </body>
</html>