<!DOCTYPE html>
<html lang="en">

   <head>
      <title>Select Box Control</title>
   </head>
   <script>
      getSSID()

      function getSSID() {
        myVar =   setTimeout(getSSID,10000)
        var xhttp = new XMLHttpRequest()
        xhttp.onreadystatechange = function() {
          if (xhttp.readyState == 4 && xhttp.status == 200) {
            const ssids = xhttp.responseText.split(" ")
            data = "<form name=\"form\" action=\"http://" + window.location.host + ":8000/setup\" method=\"POST\")>"
            data += "<select name = \"network\" onclick=clearTimeout(myVar)>"
            console.log(ssids)
            if (ssids[0] == ""){
                ssids[0] = "Loading Wi-Fi access points..."
            }
            for (let i = 0; i < ssids.length; i++) {
                if(ssids[i] != "ESSID:"){
                    data += "<option value= \"" + ssids[i] + "\">" + ssids[i] + "</option>";
                }
            }
            data += "</select><br>"
            if (ssids[0] != "Loading Wi-Fi access points..."){
                data += "<label for=\"password\">Password:</label>"
                data += "<input type=\"password\" id=\"password\" accept-charset=utf-8 name=\"Password\" oninput=clearTimeout(myVar)><br>"
                data += "<input type=\"submit\" value=\"Configure\">"
            }

            console.log(data)
            data = data.replace(/ESSID:/g,"");
            document.getElementById("networks").innerHTML = data;
          }
        };
        xhttp.open("GET", "SSID", true);
        xhttp.send();
      }


   </script>
   <body>
      <p>Airiana Wi-Fi access points. Select any one fill in your password and press configure.</p>
      <br>
      <br>
      <!--form action= window.location.hostname :8000/setup" method="post"-->
         <a>Choose your home Wi-Fi network:</a><br>
         <div id="networks" style="line-height:90%"></div>
   </body>
</html>